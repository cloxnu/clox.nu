<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>如何用 Git 命令修改历史提交 | cloxnu&#39;s Creative Space</title>

<meta name="keywords" content="" />
<meta name="description" content="在实际工程中，有时我们在以往的提交中忘记提交部分代码，当想起来的时候已经提交过很多笔了。于是想要把当前的更改提交到历史 commit 中去。
假设当前我们提交了三次：
$ git log commit 0e162000e27ba998d5a92cc04b489e3d3ec0e30d (HEAD -&gt; master) Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:46:08 2021 &#43;0800 3rd commit commit f5f470406634bb255e4f19bf62780868afeed32d Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:45:21 2021 &#43;0800 2nd commit commit cf8c580d322e459fa1acf4ef1e6d08163aeb1a21 Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:41:30 2021 &#43;0800 1st commit 这几次提交就只涉及一个文件 1.txt
$ cat 1.txt 11111111 22222222 33333333 其中第一行为第一次提交，第二行为第二次提交，第三行为第三次提交。
此时如果想要将第二次提交增加一个新文件 2.txt，该怎么操作呢？
步骤 首先新建 2.txt $ cat 2.txt 22222222 将当前的更改 stash $ git stash Saved working directory and index state WIP on master: 0e16200 3rd commit 根据之前 git log 打印的 commit 信息确定将要更改的 commit hash 值。然后使用 git rebase -i （没错，这相当于一次 rebase） $ git rebase -i f5f470406634bb255e4f19bf62780868afeed32d^ ⚠️ 注意：这里输入的提交 hash 值后需要加上 ^1，代表这次 commit 的父提交。或者：">
<meta name="author" content="Sidney Liu">
<link rel="canonical" href="https://clox.nu/blog/how-to-amend-git-history-commit/" />
<link href="/assets/css/stylesheet.min.555a4d6fef760f048c5b1bf30019b077e4b6fb2de917654189208a1f5141f43b.css" integrity="sha256-VVpNb&#43;92DwSMWxvzABmwd&#43;S2&#43;y3pF2VBiSCKH1FB9Ds=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://clox.nu/logo/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://clox.nu/logo/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://clox.nu/logo/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://clox.nu/apple-touch-icon.png">
<link rel="mask-icon" href="https://clox.nu/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.101.0" />







<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-151087524-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta property="og:title" content="如何用 Git 命令修改历史提交" />
<meta property="og:description" content="在实际工程中，有时我们在以往的提交中忘记提交部分代码，当想起来的时候已经提交过很多笔了。于是想要把当前的更改提交到历史 commit 中去。
假设当前我们提交了三次：
$ git log commit 0e162000e27ba998d5a92cc04b489e3d3ec0e30d (HEAD -&gt; master) Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:46:08 2021 &#43;0800 3rd commit commit f5f470406634bb255e4f19bf62780868afeed32d Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:45:21 2021 &#43;0800 2nd commit commit cf8c580d322e459fa1acf4ef1e6d08163aeb1a21 Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:41:30 2021 &#43;0800 1st commit 这几次提交就只涉及一个文件 1.txt
$ cat 1.txt 11111111 22222222 33333333 其中第一行为第一次提交，第二行为第二次提交，第三行为第三次提交。
此时如果想要将第二次提交增加一个新文件 2.txt，该怎么操作呢？
步骤 首先新建 2.txt $ cat 2.txt 22222222 将当前的更改 stash $ git stash Saved working directory and index state WIP on master: 0e16200 3rd commit 根据之前 git log 打印的 commit 信息确定将要更改的 commit hash 值。然后使用 git rebase -i （没错，这相当于一次 rebase） $ git rebase -i f5f470406634bb255e4f19bf62780868afeed32d^ ⚠️ 注意：这里输入的提交 hash 值后需要加上 ^1，代表这次 commit 的父提交。或者：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://clox.nu/blog/how-to-amend-git-history-commit/" />
<meta property="article:published_time" content="2021-11-05T16:37:27+08:00" />
<meta property="article:modified_time" content="2021-11-05T16:37:27+08:00" /><meta property="og:site_name" content="cloxnu&#39;s creative space" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="如何用 Git 命令修改历史提交"/>
<meta name="twitter:description" content="在实际工程中，有时我们在以往的提交中忘记提交部分代码，当想起来的时候已经提交过很多笔了。于是想要把当前的更改提交到历史 commit 中去。
假设当前我们提交了三次：
$ git log commit 0e162000e27ba998d5a92cc04b489e3d3ec0e30d (HEAD -&gt; master) Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:46:08 2021 &#43;0800 3rd commit commit f5f470406634bb255e4f19bf62780868afeed32d Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:45:21 2021 &#43;0800 2nd commit commit cf8c580d322e459fa1acf4ef1e6d08163aeb1a21 Author: cloxnu &lt;hi@clox.nu&gt; Date: Fri Nov 5 13:41:30 2021 &#43;0800 1st commit 这几次提交就只涉及一个文件 1.txt
$ cat 1.txt 11111111 22222222 33333333 其中第一行为第一次提交，第二行为第二次提交，第三行为第三次提交。
此时如果想要将第二次提交增加一个新文件 2.txt，该怎么操作呢？
步骤 首先新建 2.txt $ cat 2.txt 22222222 将当前的更改 stash $ git stash Saved working directory and index state WIP on master: 0e16200 3rd commit 根据之前 git log 打印的 commit 信息确定将要更改的 commit hash 值。然后使用 git rebase -i （没错，这相当于一次 rebase） $ git rebase -i f5f470406634bb255e4f19bf62780868afeed32d^ ⚠️ 注意：这里输入的提交 hash 值后需要加上 ^1，代表这次 commit 的父提交。或者："/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://clox.nu/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "如何用 Git 命令修改历史提交",
      "item": "https://clox.nu/blog/how-to-amend-git-history-commit/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "如何用 Git 命令修改历史提交",
  "name": "如何用 Git 命令修改历史提交",
  "description": "在实际工程中，有时我们在以往的提交中忘记提交部分代码，当想起来的时候已经提交过很多笔了。于是想要把当前的更改提交到历史 commit 中去。\n假设当前我们提交了三次：\n$ git log commit 0e162000e27ba998d5a92cc04b489e3d3ec0e30d (HEAD -\u0026amp;gt; master) Author: cloxnu …",
  "keywords": [
    
  ],
  "articleBody": "在实际工程中，有时我们在以往的提交中忘记提交部分代码，当想起来的时候已经提交过很多笔了。于是想要把当前的更改提交到历史 commit 中去。\n假设当前我们提交了三次：\n$ git log commit 0e162000e27ba998d5a92cc04b489e3d3ec0e30d (HEAD -\u003e master) Author: cloxnu Date: Fri Nov 5 13:46:08 2021 +0800 3rd commit commit f5f470406634bb255e4f19bf62780868afeed32d Author: cloxnu Date: Fri Nov 5 13:45:21 2021 +0800 2nd commit commit cf8c580d322e459fa1acf4ef1e6d08163aeb1a21 Author: cloxnu Date: Fri Nov 5 13:41:30 2021 +0800 1st commit 这几次提交就只涉及一个文件 1.txt\n$ cat 1.txt 11111111 22222222 33333333 其中第一行为第一次提交，第二行为第二次提交，第三行为第三次提交。\n此时如果想要将第二次提交增加一个新文件 2.txt，该怎么操作呢？\n步骤 首先新建 2.txt $ cat 2.txt 22222222 将当前的更改 stash $ git stash Saved working directory and index state WIP on master: 0e16200 3rd commit 根据之前 git log 打印的 commit 信息确定将要更改的 commit hash 值。然后使用 git rebase -i （没错，这相当于一次 rebase） $ git rebase -i f5f470406634bb255e4f19bf62780868afeed32d^ ⚠️ 注意：这里输入的提交 hash 值后需要加上 ^1，代表这次 commit 的父提交。或者：\n$ git rebase -i cf8c580d322e459fa1acf4ef1e6d08163aeb1a21 或\n$ git rebase -i HEAD~2 如果此时需要更改第一次提交，因为第一次提交没有父提交，所以应该输入命令\n$ git rebase -i --root 此时会进入 vim，编辑对于这些 commit 需要执行怎样的操作 pick f5f4704 2nd commit pick 0e16200 3rd commit # Rebase cf8c580..0e16200 onto cf8c580 (2 commands) # # Commands: # p, pick = use commit # r, reword = use commit, but edit the commit message # e, edit = use commit, but stop for amending # s, squash = use commit, but meld into previous commit # f, fixup = like \"squash\", but discard this commit's log message # x, exec = run command (the rest of the line) using shell # b, break = stop here (continue rebase later with 'git rebase --continue') # d, drop = remove commit # l, label = label current HEAD with a name # t, reset = reset HEAD to a label # m, merge [-C | -c ] [# ] # . create a merge commit using the original merge commit's # . message (or the oneline, if no original merge commit was # . specified). Use -c to reword the commit message. # # These lines can be re-ordered; they are executed from top to bottom. # # If you remove a line here THAT COMMIT WILL BE LOST. # # However, if you remove everything, the rebase will be aborted. # 我们当前需要变更第二次 commit，所以应该把第一行的 pick 改为 edit，然后 :wq 保存。\n此时进入这样的画面 Stopped at f5f4704... 2nd commit You can amend the commit now, with git commit --amend Once you are satisfied with your changes, run git rebase --continue 这时可以将我们 stash 后的更改 pop 出来\n$ git stash pop interactive rebase in progress; onto cf8c580 Last command done (1 command done): edit f5f4704 2nd commit Next command to do (1 remaining command): pick 0e16200 3rd commit (use \"git rebase --edit-todo\" to view and edit) You are currently editing a commit while rebasing branch 'master' on 'cf8c580'. (use \"git commit --amend\" to amend the current commit) (use \"git rebase --continue\" once you are satisfied with your changes) Changes to be committed: (use \"git restore --staged ...\" to unstage) new file: 2.txt Dropped refs/stash@{0} (15fa455ffa846f31167b311c3b7b9314f6c944db) 提交 $ git add . $ git commit --amend 并确认提交信息。\n继续进行 rebase $ git rebase --continue Successfully rebased and updated refs/heads/master. 结束。\n验证 此时我们看到第二次和第三次的提交的 hash 值都被修改了\n$ git log commit 9522b421544a86b1fc7be32bac18e889fb57b096 (HEAD -\u003e master) Author: cloxnu Date: Fri Nov 5 13:46:08 2021 +0800 3rd commit commit 903242f62a479417f1b3d759b0a64280ea43287b Author: cloxnu Date: Fri Nov 5 13:45:21 2021 +0800 2nd commit commit cf8c580d322e459fa1acf4ef1e6d08163aeb1a21 Author: cloxnu Date: Fri Nov 5 13:41:30 2021 +0800 1st commit 查看第二次提交：\n$ git show HEAD^ commit 903242f62a479417f1b3d759b0a64280ea43287b Author: cloxnu Date: Fri Nov 5 13:45:21 2021 +0800 2nd commit diff --git a/1.txt b/1.txt index ca028fb..71d9a24 100644 --- a/1.txt +++ b/1.txt @@ -1 +1,2 @@ 11111111 +22222222 diff --git a/2.txt b/2.txt new file mode 100644 index 0000000..75a1dd2 --- /dev/null +++ b/2.txt @@ -0,0 +1 @@ +22222222 https://segmentfault.com/a/1190000022506884 ↩︎\n",
  "wordCount" : "604",
  "inLanguage": "en",
  "datePublished": "2021-11-05T16:37:27+08:00",
  "dateModified": "2021-11-05T16:37:27+08:00",
  "author":{
    "@type": "Person",
    "name": "Sidney Liu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://clox.nu/blog/how-to-amend-git-history-commit/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "cloxnu's Creative Space",
    "logo": {
      "@type": "ImageObject",
      "url": "https://clox.nu/logo/favicon.ico"
    }
  }
}
</script>





</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://clox.nu/" accesskey="h" title="I&#39;m cloxnu (Alt + H)">
                <img src="/logo/logo.svg" alt="logo" aria-label="logo"
                    height="35">I&#39;m cloxnu</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                
                
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://clox.nu/news/" title="📰 𝕹𝖊𝖜𝖘">
                    <span>📰 𝕹𝖊𝖜𝖘</span>
                </a>
            </li>
            <li>
                <a href="https://clox.nu/archive/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://clox.nu/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://about.clox.nu" title="About">
                    <span>About</span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">

    <h1 class="post-title">
      如何用 Git 命令修改历史提交
    </h1>
    <div class="post-meta">

November 5, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Sidney Liu

</div>
  </header> 

  <div class="post-content">
<p>在实际工程中，有时我们在以往的提交中忘记提交部分代码，当想起来的时候已经提交过很多笔了。于是想要把当前的更改提交到历史 commit 中去。</p>
<p>假设当前我们提交了三次：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git log
</span></span><span style="display:flex;"><span>commit 0e162000e27ba998d5a92cc04b489e3d3ec0e30d <span style="color:#f92672">(</span>HEAD -&gt; master<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Author: cloxnu &lt;hi@clox.nu&gt;
</span></span><span style="display:flex;"><span>Date:   Fri Nov <span style="color:#ae81ff">5</span> 13:46:08 <span style="color:#ae81ff">2021</span> +0800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    3rd commit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit f5f470406634bb255e4f19bf62780868afeed32d
</span></span><span style="display:flex;"><span>Author: cloxnu &lt;hi@clox.nu&gt;
</span></span><span style="display:flex;"><span>Date:   Fri Nov <span style="color:#ae81ff">5</span> 13:45:21 <span style="color:#ae81ff">2021</span> +0800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    2nd commit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit cf8c580d322e459fa1acf4ef1e6d08163aeb1a21
</span></span><span style="display:flex;"><span>Author: cloxnu &lt;hi@clox.nu&gt;
</span></span><span style="display:flex;"><span>Date:   Fri Nov <span style="color:#ae81ff">5</span> 13:41:30 <span style="color:#ae81ff">2021</span> +0800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    1st commit
</span></span></code></pre></div><p>这几次提交就只涉及一个文件 <code>1.txt</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat 1.txt
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">11111111</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">22222222</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">33333333</span>
</span></span></code></pre></div><p>其中第一行为第一次提交，第二行为第二次提交，第三行为第三次提交。</p>
<p>此时如果想要将第二次提交增加一个新文件 <code>2.txt</code>，该怎么操作呢？</p>
<h2 id="步骤">步骤<a hidden class="anchor" aria-hidden="true" href="#步骤">#</a></h2>
<ol>
<li>首先新建 <code>2.txt</code></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat 2.txt
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">22222222</span>
</span></span></code></pre></div><ol start="2">
<li>将当前的更改 stash</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git stash
</span></span><span style="display:flex;"><span>Saved working directory and index state WIP on master: 0e16200 3rd commit
</span></span></code></pre></div><ol start="3">
<li>根据之前 <code>git log</code> 打印的 commit 信息确定将要更改的 commit hash 值。然后使用 <code>git rebase -i</code> （没错，这相当于一次 rebase）</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git rebase -i f5f470406634bb255e4f19bf62780868afeed32d^
</span></span></code></pre></div><blockquote>
<p>⚠️ 注意：这里输入的提交 hash 值后需要加上 <code>^</code><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>，代表这次 commit 的父提交。或者：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git rebase -i cf8c580d322e459fa1acf4ef1e6d08163aeb1a21
</span></span></code></pre></div><p>或</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git rebase -i HEAD~2
</span></span></code></pre></div></blockquote>
<blockquote>
<p>如果此时需要更改第一次提交，因为第一次提交没有父提交，所以应该输入命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git rebase -i --root
</span></span></code></pre></div></blockquote>
<ol start="4">
<li>此时会进入 vim，编辑对于这些 commit 需要执行怎样的操作</li>
</ol>
<pre tabindex="0"><code>pick f5f4704 2nd commit
pick 0e16200 3rd commit

# Rebase cf8c580..0e16200 onto cf8c580 (2 commands)
#
# Commands:
# p, pick &lt;commit&gt; = use commit
# r, reword &lt;commit&gt; = use commit, but edit the commit message
# e, edit &lt;commit&gt; = use commit, but stop for amending
# s, squash &lt;commit&gt; = use commit, but meld into previous commit
# f, fixup &lt;commit&gt; = like &#34;squash&#34;, but discard this commit&#39;s log message
# x, exec &lt;command&gt; = run command (the rest of the line) using shell
# b, break = stop here (continue rebase later with &#39;git rebase --continue&#39;)
# d, drop &lt;commit&gt; = remove commit
# l, label &lt;label&gt; = label current HEAD with a name
# t, reset &lt;label&gt; = reset HEAD to a label
# m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]
# .       create a merge commit using the original merge commit&#39;s
# .       message (or the oneline, if no original merge commit was
# .       specified). Use -c &lt;commit&gt; to reword the commit message.
#
# These lines can be re-ordered; they are executed from top to bottom.
#
# If you remove a line here THAT COMMIT WILL BE LOST.
#
# However, if you remove everything, the rebase will be aborted.
#
</code></pre><p>我们当前需要变更第二次 commit，所以应该把第一行的 <code>pick</code> 改为 <code>edit</code>，然后 <code>:wq</code> 保存。</p>
<ol start="5">
<li>此时进入这样的画面</li>
</ol>
<pre tabindex="0"><code>Stopped at f5f4704...  2nd commit
You can amend the commit now, with

  git commit --amend 

Once you are satisfied with your changes, run

  git rebase --continue
</code></pre><p>这时可以将我们 stash 后的更改 pop 出来</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git stash pop
</span></span><span style="display:flex;"><span>interactive rebase in progress; onto cf8c580
</span></span><span style="display:flex;"><span>Last command <span style="color:#66d9ef">done</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> command <span style="color:#66d9ef">done</span><span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>   edit f5f4704 2nd commit
</span></span><span style="display:flex;"><span>Next command to <span style="color:#66d9ef">do</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> remaining command<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>   pick 0e16200 3rd commit
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">(</span>use <span style="color:#e6db74">&#34;git rebase --edit-todo&#34;</span> to view and edit<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>You are currently editing a commit <span style="color:#66d9ef">while</span> rebasing branch <span style="color:#e6db74">&#39;master&#39;</span> on <span style="color:#e6db74">&#39;cf8c580&#39;</span>.
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">(</span>use <span style="color:#e6db74">&#34;git commit --amend&#34;</span> to amend the current commit<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">(</span>use <span style="color:#e6db74">&#34;git rebase --continue&#34;</span> once you are satisfied with your changes<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Changes to be committed:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">(</span>use <span style="color:#e6db74">&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>	new file:   2.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Dropped refs/stash@<span style="color:#f92672">{</span>0<span style="color:#f92672">}</span> <span style="color:#f92672">(</span>15fa455ffa846f31167b311c3b7b9314f6c944db<span style="color:#f92672">)</span>
</span></span></code></pre></div><ol start="6">
<li>提交</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git add .
</span></span><span style="display:flex;"><span>$ git commit --amend
</span></span></code></pre></div><p>并确认提交信息。</p>
<ol start="7">
<li>继续进行 rebase</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git rebase --continue
</span></span><span style="display:flex;"><span>Successfully rebased and updated refs/heads/master.
</span></span></code></pre></div><p>结束。</p>
<h2 id="验证">验证<a hidden class="anchor" aria-hidden="true" href="#验证">#</a></h2>
<p>此时我们看到第二次和第三次的提交的 hash 值都被修改了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git log
</span></span><span style="display:flex;"><span>commit 9522b421544a86b1fc7be32bac18e889fb57b096 <span style="color:#f92672">(</span>HEAD -&gt; master<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Author: cloxnu &lt;hi@clox.nu&gt;
</span></span><span style="display:flex;"><span>Date:   Fri Nov <span style="color:#ae81ff">5</span> 13:46:08 <span style="color:#ae81ff">2021</span> +0800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    3rd commit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit 903242f62a479417f1b3d759b0a64280ea43287b
</span></span><span style="display:flex;"><span>Author: cloxnu &lt;hi@clox.nu&gt;
</span></span><span style="display:flex;"><span>Date:   Fri Nov <span style="color:#ae81ff">5</span> 13:45:21 <span style="color:#ae81ff">2021</span> +0800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    2nd commit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit cf8c580d322e459fa1acf4ef1e6d08163aeb1a21
</span></span><span style="display:flex;"><span>Author: cloxnu &lt;hi@clox.nu&gt;
</span></span><span style="display:flex;"><span>Date:   Fri Nov <span style="color:#ae81ff">5</span> 13:41:30 <span style="color:#ae81ff">2021</span> +0800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    1st commit
</span></span></code></pre></div><p>查看第二次提交：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git show HEAD^
</span></span><span style="display:flex;"><span>commit 903242f62a479417f1b3d759b0a64280ea43287b
</span></span><span style="display:flex;"><span>Author: cloxnu &lt;hi@clox.nu&gt;
</span></span><span style="display:flex;"><span>Date:   Fri Nov <span style="color:#ae81ff">5</span> 13:45:21 <span style="color:#ae81ff">2021</span> +0800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    2nd commit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>diff --git a/1.txt b/1.txt
</span></span><span style="display:flex;"><span>index ca028fb..71d9a24 <span style="color:#ae81ff">100644</span>
</span></span><span style="display:flex;"><span>--- a/1.txt
</span></span><span style="display:flex;"><span>+++ b/1.txt
</span></span><span style="display:flex;"><span>@@ -1 +1,2 @@
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">11111111</span>
</span></span><span style="display:flex;"><span>+22222222
</span></span><span style="display:flex;"><span>diff --git a/2.txt b/2.txt
</span></span><span style="display:flex;"><span>new file mode <span style="color:#ae81ff">100644</span>
</span></span><span style="display:flex;"><span>index 0000000..75a1dd2
</span></span><span style="display:flex;"><span>--- /dev/null
</span></span><span style="display:flex;"><span>+++ b/2.txt
</span></span><span style="display:flex;"><span>@@ -0,0 +1 @@
</span></span><span style="display:flex;"><span>+22222222
</span></span></code></pre></div><div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://segmentfault.com/a/1190000022506884">https://segmentfault.com/a/1190000022506884</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</div>
  <footer class="post-footer">
    <nav class="paginav">
      <a class="prev" href="https://clox.nu/blog/brief-tutorial-on-telegram-bot-i/">
        <span class="title">« Prev Page</span>
        <br>
        <span>Telegram Bot 简明教程 I - 注册与发消息</span>
      </a>
      <a class="next" href="https://clox.nu/blog/optimizing-blog-experience-with-progressive-jpeg-pictures/">
        <span class="title">Next Page »</span>
        <br>
        <span>使用渐进式 JPEG 图片优化 blog 阅读体验</span>
      </a>
    </nav>
  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2022 <a href="https://clox.nu/">cloxnu&#39;s Creative Space</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a><div id="utter-container"></div>
<script src="https://utteranc.es/client.js"
    repo= 'cloxnu/clox.nu'
    issue-term= "pathname"
    theme= 'preferred-color-scheme'
    crossorigin= "anonymous"
    async>
</script>
<script defer src="/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js" integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93&#43;QdxBJM917LmaT3s9E="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
