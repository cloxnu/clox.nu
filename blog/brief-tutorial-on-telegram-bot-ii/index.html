<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Telegram Bot ç®€æ˜æ•™ç¨‹ II - æ”¶æŒ‡ä»¤ä¸æŒ‡ä»¤é”®ç›˜ | cloxnu&#39;s Creative Space</title>

<meta name="keywords" content="" />
<meta name="description" content="åœ¨æ­¤ä¹‹å‰ Telegram Bot ç®€æ˜æ•™ç¨‹ I - æ³¨å†Œä¸å‘æ¶ˆæ¯
æ”¶æŒ‡ä»¤ python-telegram-bot wiki é¡µé¢ ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Python è„šæœ¬å®ç°ä¸ Bot äº¤äº’ã€‚
ä»¥ä¸‹æ˜¯æ ¹æ®è¿™ä¸ª wiki é¡µé¢ç¼–å†™çš„ä¾‹ç¨‹ã€‚
æ¥æ”¶ /start æŒ‡ä»¤ from telegram import Update from telegram.ext import Updater, CallbackContext, CommandHandler token = &#39;2110628450:AAHQ78uj42ddtdsx0gKfaZGyFUhpnQ13vyM&#39; def start(update: Update, context: CallbackContext): context.bot.send_message(chat_id=update.effective_chat.id, text=&#34;Let&#39;s start!&#34;) # æˆ– # update.message.reply_text(&#34;Let&#39;s start!&#34;) if __name__ == &#39;__main__&#39;: updater = Updater(token=token, use_context=True) #1 start_handler = CommandHandler(&#39;start&#39;, start) #2 updater.dispatcher.add_handler(start_handler) #3 updater.start_polling() #4 updater.idle() #5  é¦–å…ˆæ ¹æ® token åˆ›å»ºä¸€ä¸ª updater å¯¹è±¡ï¼› å®šä¹‰ start å‡½æ•°ï¼Œåœ¨å‡½æ•°ä½“ä¸­å®ç°ç»™å‘æŒ‡ä»¤çš„é‚£ä¸ª chat_id å‘é€æ¶ˆæ¯ã€ŒLet&rsquo;s start!">
<meta name="author" content="Sidney Liu">
<link rel="canonical" href="https://clox.nu/blog/brief-tutorial-on-telegram-bot-ii/" />
<link href="/assets/css/stylesheet.min.555a4d6fef760f048c5b1bf30019b077e4b6fb2de917654189208a1f5141f43b.css" integrity="sha256-VVpNb&#43;92DwSMWxvzABmwd&#43;S2&#43;y3pF2VBiSCKH1FB9Ds=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://clox.nu/logo/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://clox.nu/logo/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://clox.nu/logo/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://clox.nu/apple-touch-icon.png">
<link rel="mask-icon" href="https://clox.nu/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.89.3" />







<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-151087524-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta property="og:title" content="Telegram Bot ç®€æ˜æ•™ç¨‹ II - æ”¶æŒ‡ä»¤ä¸æŒ‡ä»¤é”®ç›˜" />
<meta property="og:description" content="åœ¨æ­¤ä¹‹å‰ Telegram Bot ç®€æ˜æ•™ç¨‹ I - æ³¨å†Œä¸å‘æ¶ˆæ¯
æ”¶æŒ‡ä»¤ python-telegram-bot wiki é¡µé¢ ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Python è„šæœ¬å®ç°ä¸ Bot äº¤äº’ã€‚
ä»¥ä¸‹æ˜¯æ ¹æ®è¿™ä¸ª wiki é¡µé¢ç¼–å†™çš„ä¾‹ç¨‹ã€‚
æ¥æ”¶ /start æŒ‡ä»¤ from telegram import Update from telegram.ext import Updater, CallbackContext, CommandHandler token = &#39;2110628450:AAHQ78uj42ddtdsx0gKfaZGyFUhpnQ13vyM&#39; def start(update: Update, context: CallbackContext): context.bot.send_message(chat_id=update.effective_chat.id, text=&#34;Let&#39;s start!&#34;) # æˆ– # update.message.reply_text(&#34;Let&#39;s start!&#34;) if __name__ == &#39;__main__&#39;: updater = Updater(token=token, use_context=True) #1 start_handler = CommandHandler(&#39;start&#39;, start) #2 updater.dispatcher.add_handler(start_handler) #3 updater.start_polling() #4 updater.idle() #5  é¦–å…ˆæ ¹æ® token åˆ›å»ºä¸€ä¸ª updater å¯¹è±¡ï¼› å®šä¹‰ start å‡½æ•°ï¼Œåœ¨å‡½æ•°ä½“ä¸­å®ç°ç»™å‘æŒ‡ä»¤çš„é‚£ä¸ª chat_id å‘é€æ¶ˆæ¯ã€ŒLet&rsquo;s start!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://clox.nu/blog/brief-tutorial-on-telegram-bot-ii/" />
<meta property="article:published_time" content="2021-11-16T22:00:00+08:00" />
<meta property="article:modified_time" content="2021-11-16T22:00:00+08:00" /><meta property="og:site_name" content="cloxnu&#39;s creative space" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Telegram Bot ç®€æ˜æ•™ç¨‹ II - æ”¶æŒ‡ä»¤ä¸æŒ‡ä»¤é”®ç›˜"/>
<meta name="twitter:description" content="åœ¨æ­¤ä¹‹å‰ Telegram Bot ç®€æ˜æ•™ç¨‹ I - æ³¨å†Œä¸å‘æ¶ˆæ¯
æ”¶æŒ‡ä»¤ python-telegram-bot wiki é¡µé¢ ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Python è„šæœ¬å®ç°ä¸ Bot äº¤äº’ã€‚
ä»¥ä¸‹æ˜¯æ ¹æ®è¿™ä¸ª wiki é¡µé¢ç¼–å†™çš„ä¾‹ç¨‹ã€‚
æ¥æ”¶ /start æŒ‡ä»¤ from telegram import Update from telegram.ext import Updater, CallbackContext, CommandHandler token = &#39;2110628450:AAHQ78uj42ddtdsx0gKfaZGyFUhpnQ13vyM&#39; def start(update: Update, context: CallbackContext): context.bot.send_message(chat_id=update.effective_chat.id, text=&#34;Let&#39;s start!&#34;) # æˆ– # update.message.reply_text(&#34;Let&#39;s start!&#34;) if __name__ == &#39;__main__&#39;: updater = Updater(token=token, use_context=True) #1 start_handler = CommandHandler(&#39;start&#39;, start) #2 updater.dispatcher.add_handler(start_handler) #3 updater.start_polling() #4 updater.idle() #5  é¦–å…ˆæ ¹æ® token åˆ›å»ºä¸€ä¸ª updater å¯¹è±¡ï¼› å®šä¹‰ start å‡½æ•°ï¼Œåœ¨å‡½æ•°ä½“ä¸­å®ç°ç»™å‘æŒ‡ä»¤çš„é‚£ä¸ª chat_id å‘é€æ¶ˆæ¯ã€ŒLet&rsquo;s start!"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://clox.nu/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "https://clox.nu/posts/creation/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Telegram Bot ç®€æ˜æ•™ç¨‹ II - æ”¶æŒ‡ä»¤ä¸æŒ‡ä»¤é”®ç›˜",
      "item": "https://clox.nu/blog/brief-tutorial-on-telegram-bot-ii/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Telegram Bot ç®€æ˜æ•™ç¨‹ II - æ”¶æŒ‡ä»¤ä¸æŒ‡ä»¤é”®ç›˜",
  "name": "Telegram Bot ç®€æ˜æ•™ç¨‹ II - æ”¶æŒ‡ä»¤ä¸æŒ‡ä»¤é”®ç›˜",
  "description": "åœ¨æ­¤ä¹‹å‰ Telegram Bot ç®€æ˜æ•™ç¨‹ I - æ³¨å†Œä¸å‘æ¶ˆæ¯\næ”¶æŒ‡ä»¤ python-telegram-bot wiki é¡µé¢ ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Python è„šæœ¬å®ç°ä¸ Bot äº¤äº’ã€‚\nä»¥ä¸‹æ˜¯æ ¹æ®è¿™ä¸ª wiki é¡µé¢ç¼–å†™çš„ä¾‹ç¨‹ã€‚\næ¥æ”¶ /start æŒ‡ä»¤ from telegram import Update from telegram.ext â€¦",
  "keywords": [
    
  ],
  "articleBody": "åœ¨æ­¤ä¹‹å‰ Telegram Bot ç®€æ˜æ•™ç¨‹ I - æ³¨å†Œä¸å‘æ¶ˆæ¯\næ”¶æŒ‡ä»¤ python-telegram-bot wiki é¡µé¢ ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Python è„šæœ¬å®ç°ä¸ Bot äº¤äº’ã€‚\nä»¥ä¸‹æ˜¯æ ¹æ®è¿™ä¸ª wiki é¡µé¢ç¼–å†™çš„ä¾‹ç¨‹ã€‚\næ¥æ”¶ /start æŒ‡ä»¤ from telegram import Update from telegram.ext import Updater, CallbackContext, CommandHandler token = '2110628450:AAHQ78uj42ddtdsx0gKfaZGyFUhpnQ13vyM' def start(update: Update, context: CallbackContext): context.bot.send_message(chat_id=update.effective_chat.id, text=\"Let's start!\") # æˆ– # update.message.reply_text(\"Let's start!\") if __name__ == '__main__': updater = Updater(token=token, use_context=True) #1 start_handler = CommandHandler('start', start) #2 updater.dispatcher.add_handler(start_handler) #3 updater.start_polling() #4 updater.idle() #5  é¦–å…ˆæ ¹æ® token åˆ›å»ºä¸€ä¸ª updater å¯¹è±¡ï¼› å®šä¹‰ start å‡½æ•°ï¼Œåœ¨å‡½æ•°ä½“ä¸­å®ç°ç»™å‘æŒ‡ä»¤çš„é‚£ä¸ª chat_id å‘é€æ¶ˆæ¯ã€ŒLetâ€™s start!ã€ï¼Œå¹¶å°†è¿™ä¸ªå‡½æ•°ä¸ start æŒ‡ä»¤å…³è”ï¼› å°† start å‡½æ•°ä½œä¸º CommandHandler æ·»åŠ åˆ° update.dispatcher ä¸­ï¼› å½“å‰è®¾å®šçš„æŒ‡ä»¤å¼€å§‹è¿ä½œï¼Œç¨‹åºä¼šè‡ªåŠ¨æŒç»­åœ°å‘ Telegram çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä»¥å®æ—¶æ¥æ”¶æŒ‡ä»¤ï¼› ç­‰å¾…ç”¨æˆ· Control-C æˆ–è€…è¿›ç¨‹æ€æ­»ã€‚  è¿è¡Œæ­¤ç¨‹åºï¼Œå¹¶ä¸ Bot å¯¹è¯ï¼Œæ‰§è¡ŒæŒ‡ä»¤ /start ï¼Œç»“æœå¦‚ä¸‹ï¼š\nå¯¹è¯ from telegram import Update from telegram.ext import Updater, CallbackContext, CommandHandler, MessageHandler, Filters token = '2110628450:AAHQ78uj42ddtdsx0gKfaZGyFUhpnQ13vyM' def echo(update: Update, context: CallbackContext): context.bot.send_message(chat_id=update.effective_chat.id, text=update.message.text) if __name__ == '__main__': updater = Updater(token=token, use_context=True) echo_handler = MessageHandler(Filters.text \u0026 (~Filters.command), echo) #1 updater.dispatcher.add_handler(echo_handler) #2 updater.start_polling() updater.idle() å°†ä¹‹å‰çš„ä»£ç ç¨ä½œä¿®æ”¹ï¼š\n å°†ä¹‹å‰çš„ start å‡½æ•°æ”¹ä¸º echo å‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯å°†å‘ç»™ Bot çš„æ¶ˆæ¯å‘é€å›æ¥ï¼Œå¹¶å°†ä¹‹å‰çš„ CommandHandler æ”¹ä¸º MessageHandlerï¼Œè¿™é‡Œ Filter çš„ä½œç”¨æ˜¯è¿‡æ»¤æ–‡æœ¬å’ŒéæŒ‡ä»¤ä¿¡æ¯ï¼› æ·»åŠ åˆ° dispatcher ä¸­ã€‚  è¿è¡Œæ­¤ç¨‹åºï¼Œå¹¶ä¸ Bot å¯¹è¯ï¼ŒBot ä¼šå°†åŸè¯å‘é€å›æ¥ï¼š\næŒ‡ä»¤é”®ç›˜ å…³äºè¿™ä¸€éƒ¨åˆ†ï¼Œpython-telegram-bot æœ‰ä¸€ä¸ª ä¾‹ç¨‹ï¼Œå’Œå¯¹åº”çš„ wikiã€‚\nfrom telegram import InlineKeyboardButton, InlineKeyboardMarkup, Update from telegram.ext import Updater, CallbackContext, CommandHandler, CallbackQueryHandler def start(update: Update, context: CallbackContext): keyboard = [ [ InlineKeyboardButton(\"Option 1\", callback_data='1'), InlineKeyboardButton(\"Option 2\", callback_data='2'), ], [ InlineKeyboardButton(\"Option 3\", callback_data='3'), ] ] #1 reply_markup = InlineKeyboardMarkup(keyboard) #2 update.message.reply_text(\"Please choose:\", reply_markup=reply_markup) #3 def keyboard_callback(update: Update, context: CallbackContext): #4 query = update.callback_query #5 query.answer() #6 query.edit_message_text(text=f\"Selected option: {query.data}\") #7 if name == '__main__': updater = Updater(token=token, use_context=True) start_handler = CommandHandler('start', start) updater.dispatcher.add_handler(start_handler) updater.dispatcher.add_handler(CallbackQueryHandler(keyboard_callback)) #8 updater.start_polling() updater.idle()  åŒæ ·å›åˆ° start å‡½æ•°ï¼Œè¿™æ¬¡æˆ‘ä»¬æ›´æ”¹ä¸‹ /start æŒ‡ä»¤å†…éƒ¨é€»è¾‘ï¼Œä¸€å¼€å§‹å®šä¹‰äº†ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºå®šä¹‰äº†ä¸¤æ’æŒ‰é’®ï¼Œç¬¬ä¸€æ’æ˜¯ Option 1 å’Œ Option 2ï¼Œç¬¬äºŒæ’æ˜¯ Option 3ï¼› å°†å…¶è½¬æ¢ä¸º InlineKeyboardMarkup ç±»å‹ä»¥ä¾¿å‘é€ï¼› å°†è¿™ä¸ªæŒ‡ä»¤é”®ç›˜ä½œä¸ºå›å¤å‘é€ï¼› å®šä¹‰ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œä½œä¸ºç”¨æˆ·æŒ‰é”®ç›˜åçš„ handlerï¼› å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼Œupdate.callback_query ä¸­æ‹¥æœ‰æ­¤æŒ‡ä»¤ä¿¡æ¯ï¼Œå°†å…¶å®šä¹‰ä¸º queryï¼› è°ƒç”¨ query çš„ answer() æ–¹æ³•ï¼Œå³å‘Šè¯‰ç”¨æˆ·ã€Œå›å¤ã€äº†è¿™æ¡æŒ‡ä»¤ï¼Œè¡¨ç°ä¸ºå®¢æˆ·ç«¯ä¸å†æ˜¾ç¤ºç­‰å¾…è¿™æ¡æŒ‡ä»¤çš„ UIï¼› å°†ç”¨æˆ·é€‰æ‹©çš„å€¼ä½œä¸ºä¸€æ¡æ¶ˆæ¯è¦†ç›–åŸæ¥çš„é”®ç›˜æ¶ˆæ¯ï¼› å°†æ­¤ handler åŠ å…¥ dispatcherã€‚  è¿è¡Œæ­¤ç¨‹åºï¼Œå¹¶ä¸ Bot å¯¹è¯ï¼Œæ‰§è¡ŒæŒ‡ä»¤ /start ï¼Œç»“æœå¦‚ä¸‹ï¼š\nå½“ç‚¹é€‰ â€œOption 1â€ åï¼Œå‡ºç° Loading çš„æç¤ºåï¼ŒåŸæ¶ˆæ¯æ›´æ”¹ä¸ºä»¥ä¸‹ç»“æœï¼š\nä¸‹ä¸€æ­¥â€¦ æœªå®Œå¾…ç»­\n",
  "wordCount" : "288",
  "inLanguage": "en",
  "datePublished": "2021-11-16T22:00:00+08:00",
  "dateModified": "2021-11-16T22:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "Sidney Liu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://clox.nu/blog/brief-tutorial-on-telegram-bot-ii/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "cloxnu's Creative Space",
    "logo": {
      "@type": "ImageObject",
      "url": "https://clox.nu/logo/favicon.ico"
    }
  }
}
</script>





</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://clox.nu/" accesskey="h" title="I&#39;m cloxnu (Alt + H)">
                <img src="/logo/logo.svg" alt="logo" aria-label="logo"
                    height="35">I&#39;m cloxnu</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                
                
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://clox.nu/news/" title="ğŸ“° ğ•¹ğ–Šğ–œğ–˜">
                    <span>ğŸ“° ğ•¹ğ–Šğ–œğ–˜</span>
                </a>
            </li>
            <li>
                <a href="https://clox.nu/archive/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://clox.nu/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://about.clox.nu" title="About">
                    <span>About</span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">

    <h1 class="post-title">
      Telegram Bot ç®€æ˜æ•™ç¨‹ II - æ”¶æŒ‡ä»¤ä¸æŒ‡ä»¤é”®ç›˜
    </h1>
    <div class="post-meta">

November 16, 2021&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Sidney Liu

</div>
  </header> 

  <div class="post-content">
<h2 id="åœ¨æ­¤ä¹‹å‰">åœ¨æ­¤ä¹‹å‰<a hidden class="anchor" aria-hidden="true" href="#åœ¨æ­¤ä¹‹å‰">#</a></h2>
<p><a href="../brief-tutorial-on-telegram-bot-i/">Telegram Bot ç®€æ˜æ•™ç¨‹ I - æ³¨å†Œä¸å‘æ¶ˆæ¯</a></p>
<h2 id="æ”¶æŒ‡ä»¤">æ”¶æŒ‡ä»¤<a hidden class="anchor" aria-hidden="true" href="#æ”¶æŒ‡ä»¤">#</a></h2>
<p><a href="https://github.com/python-telegram-bot/python-telegram-bot/wiki/Extensions-%E2%80%93-Your-first-Bot">python-telegram-bot wiki é¡µé¢</a> ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Python è„šæœ¬å®ç°ä¸ Bot äº¤äº’ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ ¹æ®è¿™ä¸ª wiki é¡µé¢ç¼–å†™çš„ä¾‹ç¨‹ã€‚</p>
<h3 id="æ¥æ”¶-start-æŒ‡ä»¤">æ¥æ”¶ <code>/start</code> æŒ‡ä»¤<a hidden class="anchor" aria-hidden="true" href="#æ¥æ”¶-start-æŒ‡ä»¤">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">from</span> telegram <span style="color:#f92672">import</span> Update
<span style="color:#f92672">from</span> telegram.ext <span style="color:#f92672">import</span> Updater, CallbackContext, CommandHandler

token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2110628450:AAHQ78uj42ddtdsx0gKfaZGyFUhpnQ13vyM&#39;</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start</span>(update: Update, context: CallbackContext):
    context<span style="color:#f92672">.</span>bot<span style="color:#f92672">.</span>send_message(chat_id<span style="color:#f92672">=</span>update<span style="color:#f92672">.</span>effective_chat<span style="color:#f92672">.</span>id, text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Let&#39;s start!&#34;</span>)
    <span style="color:#75715e"># æˆ–</span>
    <span style="color:#75715e"># update.message.reply_text(&#34;Let&#39;s start!&#34;)</span>


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    updater <span style="color:#f92672">=</span> Updater(token<span style="color:#f92672">=</span>token, use_context<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>) <span style="color:#75715e">#1</span>
    start_handler <span style="color:#f92672">=</span> CommandHandler(<span style="color:#e6db74">&#39;start&#39;</span>, start) <span style="color:#75715e">#2</span>
    updater<span style="color:#f92672">.</span>dispatcher<span style="color:#f92672">.</span>add_handler(start_handler) <span style="color:#75715e">#3</span>
    updater<span style="color:#f92672">.</span>start_polling() <span style="color:#75715e">#4</span>
    updater<span style="color:#f92672">.</span>idle() <span style="color:#75715e">#5</span>
</code></pre></div><ol>
<li>é¦–å…ˆæ ¹æ® token åˆ›å»ºä¸€ä¸ª <code>updater</code> å¯¹è±¡ï¼›</li>
<li>å®šä¹‰ <code>start</code> å‡½æ•°ï¼Œåœ¨å‡½æ•°ä½“ä¸­å®ç°ç»™å‘æŒ‡ä»¤çš„é‚£ä¸ª <code>chat_id</code> å‘é€æ¶ˆæ¯ã€ŒLet&rsquo;s start!ã€ï¼Œå¹¶å°†è¿™ä¸ªå‡½æ•°ä¸ <code>start</code> æŒ‡ä»¤å…³è”ï¼›</li>
<li>å°† <code>start</code> å‡½æ•°ä½œä¸º <code>CommandHandler</code> æ·»åŠ åˆ° <code>update.dispatcher</code> ä¸­ï¼›</li>
<li>å½“å‰è®¾å®šçš„æŒ‡ä»¤å¼€å§‹è¿ä½œï¼Œç¨‹åºä¼šè‡ªåŠ¨æŒç»­åœ°å‘ Telegram çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä»¥å®æ—¶æ¥æ”¶æŒ‡ä»¤ï¼›</li>
<li>ç­‰å¾…ç”¨æˆ· Control-C æˆ–è€…è¿›ç¨‹æ€æ­»ã€‚</li>
</ol>
<p>è¿è¡Œæ­¤ç¨‹åºï¼Œå¹¶ä¸ Bot å¯¹è¯ï¼Œæ‰§è¡ŒæŒ‡ä»¤ <code>/start</code> ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="assets/IMG_1.jpg" alt="å›¾ç‰‡"></p>
<h3 id="å¯¹è¯">å¯¹è¯<a hidden class="anchor" aria-hidden="true" href="#å¯¹è¯">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">from</span> telegram <span style="color:#f92672">import</span> Update
<span style="color:#f92672">from</span> telegram.ext <span style="color:#f92672">import</span> Updater, CallbackContext, CommandHandler, MessageHandler, Filters

token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2110628450:AAHQ78uj42ddtdsx0gKfaZGyFUhpnQ13vyM&#39;</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(update: Update, context: CallbackContext):
    context<span style="color:#f92672">.</span>bot<span style="color:#f92672">.</span>send_message(chat_id<span style="color:#f92672">=</span>update<span style="color:#f92672">.</span>effective_chat<span style="color:#f92672">.</span>id, text<span style="color:#f92672">=</span>update<span style="color:#f92672">.</span>message<span style="color:#f92672">.</span>text)
    

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    updater <span style="color:#f92672">=</span> Updater(token<span style="color:#f92672">=</span>token, use_context<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
    echo_handler <span style="color:#f92672">=</span> MessageHandler(Filters<span style="color:#f92672">.</span>text <span style="color:#f92672">&amp;</span> (<span style="color:#f92672">~</span>Filters<span style="color:#f92672">.</span>command), echo) <span style="color:#75715e">#1</span>
    updater<span style="color:#f92672">.</span>dispatcher<span style="color:#f92672">.</span>add_handler(echo_handler) <span style="color:#75715e">#2</span>
    updater<span style="color:#f92672">.</span>start_polling()
    updater<span style="color:#f92672">.</span>idle()
</code></pre></div><p>å°†ä¹‹å‰çš„ä»£ç ç¨ä½œä¿®æ”¹ï¼š</p>
<ol>
<li>å°†ä¹‹å‰çš„ <code>start</code> å‡½æ•°æ”¹ä¸º <code>echo</code> å‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯å°†å‘ç»™ Bot çš„æ¶ˆæ¯å‘é€å›æ¥ï¼Œå¹¶å°†ä¹‹å‰çš„ <code>CommandHandler</code> æ”¹ä¸º <code>MessageHandler</code>ï¼Œè¿™é‡Œ <code>Filter</code> çš„ä½œç”¨æ˜¯è¿‡æ»¤æ–‡æœ¬å’ŒéæŒ‡ä»¤ä¿¡æ¯ï¼›</li>
<li>æ·»åŠ åˆ° <code>dispatcher</code> ä¸­ã€‚</li>
</ol>
<p>è¿è¡Œæ­¤ç¨‹åºï¼Œå¹¶ä¸ Bot å¯¹è¯ï¼ŒBot ä¼šå°†åŸè¯å‘é€å›æ¥ï¼š</p>
<p><img src="assets/IMG_2.jpg" alt="å›¾ç‰‡"></p>
<h3 id="æŒ‡ä»¤é”®ç›˜">æŒ‡ä»¤é”®ç›˜<a hidden class="anchor" aria-hidden="true" href="#æŒ‡ä»¤é”®ç›˜">#</a></h3>
<p>å…³äºè¿™ä¸€éƒ¨åˆ†ï¼Œpython-telegram-bot æœ‰ä¸€ä¸ª <a href="https://github.com/python-telegram-bot/python-telegram-bot/blob/master/examples/inlinekeyboard.py">ä¾‹ç¨‹</a>ï¼Œå’Œå¯¹åº”çš„ <a href="https://github.com/python-telegram-bot/python-telegram-bot/wiki/InlineKeyboard-Example">wiki</a>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#f92672">from</span> telegram <span style="color:#f92672">import</span> InlineKeyboardButton, InlineKeyboardMarkup, Update
<span style="color:#f92672">from</span> telegram.ext <span style="color:#f92672">import</span> Updater, CallbackContext, CommandHandler, CallbackQueryHandler

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start</span>(update: Update, context: CallbackContext):
    keyboard <span style="color:#f92672">=</span> [
        [
            InlineKeyboardButton(<span style="color:#e6db74">&#34;Option 1&#34;</span>, callback_data<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1&#39;</span>),
            InlineKeyboardButton(<span style="color:#e6db74">&#34;Option 2&#34;</span>, callback_data<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2&#39;</span>),
        ],
        [
            InlineKeyboardButton(<span style="color:#e6db74">&#34;Option 3&#34;</span>, callback_data<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;3&#39;</span>),
        ]
    ] <span style="color:#75715e">#1</span>
    reply_markup <span style="color:#f92672">=</span> InlineKeyboardMarkup(keyboard) <span style="color:#75715e">#2</span>
    update<span style="color:#f92672">.</span>message<span style="color:#f92672">.</span>reply_text(<span style="color:#e6db74">&#34;Please choose:&#34;</span>, reply_markup<span style="color:#f92672">=</span>reply_markup) <span style="color:#75715e">#3</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">keyboard_callback</span>(update: Update, context: CallbackContext): <span style="color:#75715e">#4</span>
    query <span style="color:#f92672">=</span> update<span style="color:#f92672">.</span>callback_query <span style="color:#75715e">#5</span>
    query<span style="color:#f92672">.</span>answer() <span style="color:#75715e">#6</span>
    query<span style="color:#f92672">.</span>edit_message_text(text<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Selected option: </span><span style="color:#e6db74">{</span>query<span style="color:#f92672">.</span>data<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>) <span style="color:#75715e">#7</span>
    
<span style="color:#66d9ef">if</span> name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    updater <span style="color:#f92672">=</span> Updater(token<span style="color:#f92672">=</span>token, use_context<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
    start_handler <span style="color:#f92672">=</span> CommandHandler(<span style="color:#e6db74">&#39;start&#39;</span>, start)
    updater<span style="color:#f92672">.</span>dispatcher<span style="color:#f92672">.</span>add_handler(start_handler)
    updater<span style="color:#f92672">.</span>dispatcher<span style="color:#f92672">.</span>add_handler(CallbackQueryHandler(keyboard_callback)) <span style="color:#75715e">#8</span>
    updater<span style="color:#f92672">.</span>start_polling()
    updater<span style="color:#f92672">.</span>idle()
</code></pre></div><ol>
<li>åŒæ ·å›åˆ° <code>start</code> å‡½æ•°ï¼Œè¿™æ¬¡æˆ‘ä»¬æ›´æ”¹ä¸‹ <code>/start</code> æŒ‡ä»¤å†…éƒ¨é€»è¾‘ï¼Œä¸€å¼€å§‹å®šä¹‰äº†ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºå®šä¹‰äº†ä¸¤æ’æŒ‰é’®ï¼Œç¬¬ä¸€æ’æ˜¯ <code>Option 1</code> å’Œ <code>Option 2</code>ï¼Œç¬¬äºŒæ’æ˜¯ <code>Option 3</code>ï¼›</li>
<li>å°†å…¶è½¬æ¢ä¸º <code>InlineKeyboardMarkup</code> ç±»å‹ä»¥ä¾¿å‘é€ï¼›</li>
<li>å°†è¿™ä¸ªæŒ‡ä»¤é”®ç›˜ä½œä¸ºå›å¤å‘é€ï¼›</li>
<li>å®šä¹‰ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œä½œä¸ºç”¨æˆ·æŒ‰é”®ç›˜åçš„ handlerï¼›</li>
<li>å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼Œ<code>update.callback_query</code> ä¸­æ‹¥æœ‰æ­¤æŒ‡ä»¤ä¿¡æ¯ï¼Œå°†å…¶å®šä¹‰ä¸º <code>query</code>ï¼›</li>
<li>è°ƒç”¨ <code>query</code> çš„ <code>answer()</code> æ–¹æ³•ï¼Œå³å‘Šè¯‰ç”¨æˆ·ã€Œå›å¤ã€äº†è¿™æ¡æŒ‡ä»¤ï¼Œè¡¨ç°ä¸ºå®¢æˆ·ç«¯ä¸å†æ˜¾ç¤ºç­‰å¾…è¿™æ¡æŒ‡ä»¤çš„ UIï¼›</li>
<li>å°†ç”¨æˆ·é€‰æ‹©çš„å€¼ä½œä¸ºä¸€æ¡æ¶ˆæ¯è¦†ç›–åŸæ¥çš„é”®ç›˜æ¶ˆæ¯ï¼›</li>
<li>å°†æ­¤ handler åŠ å…¥ <code>dispatcher</code>ã€‚</li>
</ol>
<p>è¿è¡Œæ­¤ç¨‹åºï¼Œå¹¶ä¸ Bot å¯¹è¯ï¼Œæ‰§è¡ŒæŒ‡ä»¤ <code>/start</code> ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="assets/IMG_3.jpg" alt="å›¾ç‰‡"></p>
<p>å½“ç‚¹é€‰ &ldquo;Option 1&rdquo; åï¼Œå‡ºç° Loading çš„æç¤ºåï¼ŒåŸæ¶ˆæ¯æ›´æ”¹ä¸ºä»¥ä¸‹ç»“æœï¼š</p>
<p><img src="assets/IMG_4.jpg" alt="å›¾ç‰‡"></p>
<h2 id="ä¸‹ä¸€æ­¥">ä¸‹ä¸€æ­¥&hellip;<a hidden class="anchor" aria-hidden="true" href="#ä¸‹ä¸€æ­¥">#</a></h2>
<p>æœªå®Œå¾…ç»­</p>

</div>
  <footer class="post-footer">
    <nav class="paginav">
      <a class="next" href="https://clox.nu/blog/brief-tutorial-on-telegram-bot-i/">
        <span class="title">Next Page Â»</span>
        <br>
        <span>Telegram Bot ç®€æ˜æ•™ç¨‹ I - æ³¨å†Œä¸å‘æ¶ˆæ¯</span>
      </a>
    </nav>
  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2021 <a href="https://clox.nu/">cloxnu&#39;s Creative Space</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a><div id="utter-container"></div>
<script src="https://utteranc.es/client.js"
    repo= 'cloxnu/clox.nu'
    issue-term= "pathname"
    theme= 'preferred-color-scheme'
    crossorigin= "anonymous"
    async>
</script>
<script defer src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
